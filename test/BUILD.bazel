package(default_visibility = ["//visibility:private"])

COMMON_COPTS = [
    "-g",
    "-O0",
    "-fno-omit-frame-pointer",
]

COMMON_DEPS = [
    "//test/unity:unity",
    "//:runtime_lib_test",
    "//:system_libs",
]

COMMON_LINKOPTS = [
    "-rdynamic",
]

cc_test(
    name = "alloc_test",
    srcs = ["unit/alloc_test.c"],
    copts = COMMON_COPTS,
    linkopts = COMMON_LINKOPTS,
    deps = COMMON_DEPS,
)

cc_test(
    name = "asyncio_test_ascan",
    srcs = ["integration/asyncio_test/ascan.c"],
    copts = COMMON_COPTS,
    linkopts = COMMON_LINKOPTS,
    deps = COMMON_DEPS,
    data = glob(["data/*"]),
)

cc_test(
    name = "asyncio_test_afread",
    srcs = ["integration/asyncio_test/afread.c"],
    copts = COMMON_COPTS,
    linkopts = COMMON_LINKOPTS,
    deps = COMMON_DEPS,
    data = glob(["data/*"]),
)

cc_test(
    name = "asyncio_test_aprintf",
    srcs = ["integration/asyncio_test/aprintf.c"],
    copts = COMMON_COPTS,
    linkopts = COMMON_LINKOPTS,
    deps = COMMON_DEPS,
    data = glob(["data/*"]),
)

cc_test(
    name = "asyncio_test_afwrite",
    srcs = ["integration/asyncio_test/afwrite.c"],
    copts = COMMON_COPTS,
    linkopts = COMMON_LINKOPTS,
    deps = COMMON_DEPS,
    data = glob(["data/*"]),
)

cc_test(
    name = "scheduler_test",
    srcs = ["integration/scheduler_test.c"],
    copts = COMMON_COPTS,
    linkopts = COMMON_LINKOPTS,
    deps = COMMON_DEPS,
)

cc_test(
    name = "syncio_test",
    srcs = ["unit/syncio_test.c"],
    copts = COMMON_COPTS,
    linkopts = COMMON_LINKOPTS,
    deps = COMMON_DEPS,
    data = glob(["data/*"]),
)

cc_test(
    name = "array_test",
    srcs = ["unit/array_test.c"],
    copts = COMMON_COPTS,
    linkopts = COMMON_LINKOPTS,
    deps = COMMON_DEPS,
)

cc_test(
    name = "atomic_test",
    srcs = ["unit/atomic_test.c"],
    copts = COMMON_COPTS,
    linkopts = COMMON_LINKOPTS,
    deps = COMMON_DEPS,
)

cc_test(
    name = "netio_test",
    srcs = ["integration/netio_test/anread.c"],
    copts = COMMON_COPTS,
    linkopts = COMMON_LINKOPTS,
    deps = COMMON_DEPS,
)
